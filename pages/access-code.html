
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Compacta D', sans-serif;

            background: #000;
            background-image: url("../assets/backgrounds/square.png");
            background-size: 0.5rem;
            background-repeat: repeat;
        }

        /* MAIN PANEL */
        .access-box {
            position: relative;
            background-color: #a10a0a59;
            padding: 30px 20px;

            border: 4px solid #000;
            border-radius: 18px;

            width: 90%;
            max-width: 400px;
            text-align: center;

            /* Hard cel-style shadow */
            box-shadow: 6px 6px 0 #000;
        }

        /* SUBTLE GRIME OVERLAY */
        .access-box::after {
            content: "";
            position: absolute;
            inset: 0;
            background-image:
                repeating-linear-gradient(-20deg,
                    rgba(0, 0, 0, 0.15) 0,
                    rgba(0, 0, 0, 0.15) 1px,
                    transparent 1px,
                    transparent 4px);
            opacity: 0.25;
            pointer-events: none;
            border-radius: 18px;
        }

        /* HEADER TEXT */
        h2 {
            margin-bottom: 20px;
            font-size: 1.4em;
            font-weight: bold;
            letter-spacing: 0.02em;
            text-transform: uppercase;

            /* Muted gold, not neon */
            color: #d1a800;

            /* Thick ink outline */
            -webkit-text-stroke: 4px #000;
            paint-order: stroke fill;

            /* Hard cartoon shadow */
            text-shadow: 2px 2px 0 #000;

            pointer-events: none;
        }

        /* INPUT */
        input {
            width: 80%;
            padding: 12px;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;

            background: #f5f5f5;
            color: #000;

            border: 4px solid #000;
            border-radius: 10px;

            box-shadow: 4px 4px 0 #000;
            margin-bottom: 15px;
        }

        /* BUTTON */
        button {
            font-family: 'Compacta D', sans-serif;
            font-weight: bold;
            font-size: 1.2em;
            padding: 12px 25px;

            background: #d1a800;
            /* gold, not yellow */
            color: #777;

            border: 4px solid #000;
            border-radius: 10px;

            -webkit-text-stroke: 3px #000;
            paint-order: stroke fill;

            box-shadow: 4px 4px 0 #000;
            cursor: pointer;

            transition: transform 0.1s ease;
        }

        button:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 #000;
        }

        /* ERROR TEXT */
        .error {
            margin-bottom: 10px;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.9em;

            color: #fff;
            text-shadow: 2px 2px 0 #000;
        }
    </style>




    <div class="access-box" id="accessBox">
        <h2>IF YOU HAVE THE ACCESS CODE, NOW WOULD BE A GOOD TIME TO USE IT.</h2>
        <div class="error" id="errorMsg"></div>
        <input type="text" id="codeInput" maxlength="6" placeholder="Enter code">
        <br>
        <button onclick="checkCode()">SUBMIT</button>
    </div>

    <script>
        
        // Auto-redirect if access code already exists
 const savedCode = localStorage.getItem("accessCode");

if (savedCode) {
  requestAnimationFrame(() => {
    document.dispatchEvent(new CustomEvent("spa-next-page"));
  });
}



        const CORRECT_CODE = "705634";
        let accessBox = document.getElementById('accessBox');
        let codeInput = document.getElementById('codeInput');
        let errorMsg = document.getElementById('errorMsg');

        function checkCode() {
            const input = codeInput.value.trim();
            errorMsg.textContent = "";

            if (!accessBox.dataset.stage) {
                // Stage 1: Initial access code
                if (input === CORRECT_CODE) {
                    showNewCodePrompt();
                } else if (input === "") {
                    errorMsg.textContent = "Really? Enter the code!";
                } else {
                    errorMsg.textContent = `NOPE, ${input} IS INCORRECT. TRY AGAIN HUMAN.`;
                }

            } else if (accessBox.dataset.stage === "new") {
                // Stage 2: New code creation
                if (validateNewCode(input)) {
                    localStorage.setItem("accessCode", input);

                    accessBox.innerHTML = `
        <h2>
          Your code is as unpredictable as I like it. Access granted.
          <br><br>
          You will use this code later to access the system.
          I hope you remembered it!
        </h2>
        <button type="button" onclick="continueToNext()">CONTINUE</button>
      `;
                }
            }
        }


        function continueToNext() {
            document.dispatchEvent(new CustomEvent("spa-next-page"));
        }


        function showNewCodePrompt() {
            accessBox.dataset.stage = "new";
            accessBox.innerHTML = `
      <h2>Now create a brand-new 6-digit access code.<br>Keep it unpredictable and chaotic.</h2>
      <div class="error" id="errorMsg"></div>
      <input type="text" id="codeInput" maxlength="6" placeholder="Enter new code">
      <br>
      <button onclick="checkCode()">Submit</button>
    `;
            // Update references to new input and error elements
            codeInput = document.getElementById('codeInput');
            errorMsg = document.getElementById('errorMsg');
        }

        function validateNewCode(code) {
            // Must be exactly 6 digits
            if (!/^\d{6}$/.test(code)) {
                errorMsg.textContent = "Six digits. Not five. Not seven. Focus.";
                return false;
            }

            // Easter egg
            if (code === "696969" || code === "969696") {
                errorMsg.textContent = "Nice. Immature. Predictable. Try again.";
                return false;
            }
            const digits = code.split("");

            // Must contain at least 4 unique digits
            const uniqueDigits = new Set(digits);
            if (uniqueDigits.size < 4) {
                errorMsg.textContent = "Too simple. Use at least four different numbers.";
                return false;
            }

            // No sequential numbers (forward or backward)
            for (let i = 0; i < digits.length - 1; i++) {
                const current = Number(digits[i]);
                const next = Number(digits[i + 1]);

                if (next === current + 1 || next === current - 1) {
                    errorMsg.textContent = "No sequences. Chaos only.";
                    return false;
                }
            }

            return true;
        }

    </script>

</html>






